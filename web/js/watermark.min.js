class WaterMark{constructor(a,b,c){c=c||void 0,this.canvas=b,this.ctx=b.getContext("2d"),this.video=a,this.waterMark=c,this.wmURL=void 0,this.canvasSizingObject={},this.yOffset=0,this.xOffset=0,this.watermarkPosition=1,this.targetWidth=0,this.targetHeight=0,this.textWidth=10,this.textHeight=10,this.colorRandom=!1,this.enableLSD=!1}set newCanvasById(a){this.canvas=document.getElementById(a)}set newCanvasByClass(a){this.canvas=document.getElementsByClassName(a)}set selectCanvasId(a){a=a||0,this.canvas=this.canvas[a]}set canvasSizeFromOtherDomObjectById(a){this.canvasSizingObject=document.getElementById(a)}set newVideoById(a){this.video=document.getElementById(a)}set newVideoByClass(a){this.video=document.getElementsByClassName(a)}set selectVideoId(a){a=a||0,this.video=this.video[a]}set newWatermark(a){this.waterMark=a}set watermarkURL(a){this.wmURL=a}set canvasText(a){this.text={name:a.name,address:a.address,phone:a.phone,email:a.email,color:a.color}}set LSD(a){this.enableLSD=a}set textRandomColor(a){this.colorRandom=a}set displayByText(a){this.textDisplay=a}get data(){return[this.canvas,this.video,this.waterMark,this.canvasSizingObject,this.image]}async fetchWaterkarkImageByURL(){if(this.wmURL!==void 0){let a=await fetch(this.wmURL),b=await a.blob(),c=new Image;c.src=URL.createObjectURL(b),this.image=c}else return new Error("\u041E\u0442\u0441\u0443\u0442\u0441\u0432\u0443\u0435\u0442 \u0441\u0441\u044B\u043B\u043A\u0430 \u043D\u0430 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435. \u0412\u044B\u043F\u043E\u043B\u043D\u0438\u0442\u0435 WaterMark().watermarkURL(`url`) \u0447\u0442\u043E\u0431\u044B \u0437\u0430\u0434\u0430\u0442\u044C \u0441\u0441\u044B\u043B\u043A\u0443 \u0434\u043B\u044F \u0441\u043A\u0430\u0447\u0438\u0432\u0430\u043D\u0438\u044F \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F.")}startLoopDrawCanvas(a,b,c){a=a||20,(void 0!==this.canvasSizingObject||{}!==this.canvasSizingObject)&&(b=b||this.canvasSizingObject.clientWidth,c=c||this.canvasSizingObject.clientHeight),this.canvas.width=b,this.canvas.height=c,1.77<=this.video.videoWidth/this.video.videoHeight?(this.targetWidth=b,this.targetHeight=b/(this.video.videoWidth/this.video.videoHeight),this.xOffset=0,this.yOffset=(c-this.targetHeight)/2):(this.targetWidth=c*(this.video.videoWidth/this.video.videoHeight),this.targetHeight=c,this.yOffset=0,this.xOffset=(b-this.targetWidth)/2);let d=b/80,e=`${this.text.name}\n${void 0===this.text.phone||""===this.text.phone?this.text.phone:this.text.address}\n${this.text.email}`,f=e.split("\n");if(this.textHeight=14>d?14:b/80,!1!==this.image.complete)if(this.ctx.drawImage(this.video,this.xOffset,this.yOffset,this.targetWidth,this.targetHeight),void 0!==this.text&&this.textDisplay){this.ctx.font=`${this.textHeight}pt Arial`,this.ctx.textBaseline="top",this.ctx.fillStyle=this.enableLSD?"#"+Math.floor(16777215*Math.random()).toString(16):this.text.color;let a=[];for(let b=0;b<f.length;b++){this.ctx.fillText(f[b],this.watermarkXOffset,this.watermarkYOffset+b*(this.textHeight+10));let c=this.ctx.measureText(f[b]).width;a.push(Math.floor(c))}this.textWidth=this.getMaxOfArray(a)}else this.ctx.drawImage(this.image,this.watermarkXOffset,this.watermarkYOffset);this.timeoutId=setTimeout(()=>{this.startLoopDrawCanvas()},a)}enableReloadBySize(a,b){b=b||!1,this.reloadBySize=a?b:a}startLoopDrawWatermark(){switch(this.reloadBySize&&this.canvasSizingObject.offsetWidth>this.reloadBySize&&window.location.reload(),void 0===this.watermarkXOffset&&(this.watermarkXOffset=this.xOffset,this.watermarkYOffset=this.yOffset),this.colorRandom&&(this.text.color="#"+Math.floor(16777215*Math.random()).toString(16)),this.watermarkPosition){case 1:this.watermarkXOffset=this.xOffset+5,this.watermarkYOffset=this.yOffset+5;break;case 2:this.watermarkXOffset=this.textDisplay?this.targetWidth+this.xOffset-this.textWidth-5:this.targetWidth+this.xOffset-405,this.watermarkYOffset=this.yOffset+5;break;case 3:this.watermarkXOffset=this.xOffset+5,this.watermarkYOffset=this.textDisplay?this.targetHeight+this.yOffset-3*(this.textHeight+10):this.targetHeight+this.yOffset-85;break;case 4:this.textDisplay?(this.watermarkXOffset=this.targetWidth+this.xOffset-this.textWidth-5,this.watermarkYOffset=this.targetHeight+this.yOffset-3*(this.textHeight+10)):(this.watermarkXOffset=this.targetWidth+this.xOffset-405,this.watermarkYOffset=this.targetHeight+this.yOffset-85);}this.watermarkPosition=this.randomInteger(1,4,this.watermarkPosition)}getMaxOfArray(a){return Math.max.apply(null,a)}randomInteger(a,b,c){let d=a-.5+Math.random()*(b-a+1);return Math.round(d)===c?this.randomInteger(a,b,c):Math.round(d)}}setTimeout(()=>{let a=new WaterMark(videoCanvas,document.getElementById("videoWM"));a.canvasSizeFromOtherDomObjectById="videoWaterMark",a.watermarkURL=`${window.location.protocol}//${window.location.host}/site/watermark`,a.textRandomColor=!0,a.displayByText=!0,a.canvasText=waterMarkInfo,a.LSD=!1,a.enableReloadBySize(!1,2500),a.fetchWaterkarkImageByURL().then(()=>{a.startLoopDrawWatermark(),setInterval(()=>{a.startLoopDrawWatermark()},3e3),a.startLoopDrawCanvas(25)})},5e3);